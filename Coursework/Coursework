; Coursework assembly program
%include "/home/malware/asm/joey_lib_io_v6_release.asm"
global main
section .data
    menu_str db 10, \
                        "Main Menu", 10, \
                        "1. Add user", 10, \
                        "2. Remove user", 10, \
                        "3. Add computer", 10, \
                        "4. Remove computer", 10, \
                        "5. List all users", 10, \
                        "6. List all computers", 10,\
                        "7. Exit", 10,\
                        "Please enter an option 1-7: ", 10,0
                         
    str_forename db "Enter forename: ", 10, 0
    str_surname db "Enter surname: ", 10, 0
    str_age db "Enter age: ", 10, 0
    str_id db "Enter id: ", 10, 0
    str_email db "Enter email: ", 10, 0
    str_comp_name db "Enter computer name: ", 10, 0
    str_comp_ip db "Enter computer ID: ", 10, 0
    str_comp_os db "Enter computer OS: ", 10, 0
    str_user_id db "Enter the user id: ", 10, 0
    str_DOP db "Enter date of purchase; ", 10 ,0
    
    str_option_num db "Option selected: ", 0
    str_wrong_option db "No such option, please try again! ", 10, 0
    str_exit db "You have exited the program!", 10, 0
    
    
    
                        
display_menu:
    push rdi
    mov rdi, menu_str
    call print_string_new
    pop rdi
    ret
                                                
main:
    mov rbp, rsp; for correct debugging
    ; We have these three lines for compatability only
    push rbp
    mov rbp, rsp
    sub rsp,32
    

    
    .menu_loop:
        call display_menu
        call read_int_new
        mov rdx, rax
        cmp rdx, 7; Compares RDX to 7
        je exit ;Exits if it is equal 7
        mov rdi, str_wrong_option
        call print_string_new
        jmp .menu_loop
        
exit:
    
    xor rax,rax ;return 0
    ;compatibility lines
    add rsp, 32
    pop rbp
    ;end of lines
    ret